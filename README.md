# -
在blender将灰度图存储在rgb各通道上，节省资源
此插件99%代码由ai完成
### **脚本的主要功能**
1. **灰度图合并**：
   - 支持将多个灰度图（或其他通道图像）合并为一个完整的图像。
   - 支持超大图像的分块处理，避免内存不足的问题。

2. **分块处理**：
   - 将大图像分成小块（tiles）进行处理，处理完成后将分块结果合并。
   - 用户可以设置分块的大小（默认为1024x1024像素）。

3. **通道配置**：
   - 用户可以选择红（R）、绿（G）、蓝（B）、Alpha（A）通道的输入图像。
   - 支持RGB和RGBA两种输出类型。

4. **输出配置**：
   - 支持多种输出格式：PNG、EXR（浮点）、JPEG、TIFF。
   - 用户可以自定义输出图像的名称和保存路径。

5. **用户界面集成**：
   - 插件集成到Blender的“着色器编辑器”侧边栏中，用户可以通过图形界面进行操作。
   - 提供了一个面板，用户可以在其中配置通道、分块大小、输出格式等参数。

### **脚本的工作流程**
1. **输入图像收集**：
   - 用户选择每个通道（R、G、B、A）的输入图像。
   - 插件会验证输入图像是否存在，并确保所有图像的尺寸一致。

2. **分块处理**：
   - 将输入图像分成指定大小的分块。
   - 对每个分块进行处理，将对应通道的数据合并到目标图像中。

3. **输出图像创建**：
   - 创建一个新的Blender图像数据块，用于存储合并后的结果。
   - 根据用户选择的格式，将图像保存到指定路径。

4. **进度条更新**：
   - 在处理过程中，插件会显示进度条，用户可以实时了解处理进度。

### **脚本的使用场景**
1. **材质制作**：
   - 在3D建模和渲染中，用户可以将多个灰度图（如法线贴图、粗糙度贴图等）合并为一个完整的材质贴图。

2. **超大图像处理**：
   - 对于分辨率非常高的图像（如8K或更高），直接处理可能会导致内存不足。通过分块处理，可以高效地完成任务。

3. **自定义工作流程**：
   - 用户可以根据自己的需求配置通道、输出格式等参数，灵活地完成图像合并任务。

### **脚本的优势**
1. **高效处理大图像**：
   - 通过分块处理，避免了直接处理超大图像导致的内存问题。

2. **用户友好**：
   - 提供了图形界面，用户可以通过简单的操作完成复杂的图像合并任务。

3. **灵活的输出配置**：
   - 支持多种输出格式和自定义保存路径，满足不同场景的需求。
   - 安装
   - 
   - 将提供的脚本代码保存为一个 `.py` 文件，例如 `texture_merge.py`。
   - 或者，将脚本压缩为一个 `.zip` 文件。

2. **打开 Blender**：
   - 启动 Blender 软件。

3. **进入偏好设置**：
   - 点击顶部菜单栏的 **编辑(Edit)** > **偏好设置(Preference)**。

4. **安装插件**：
   - 在偏好设置窗口中，选择左侧的 **插件(Add-ons)**。
   - 点击右下角的 **安装(Install)** 按钮。
   - 在弹出的文件选择窗口中，选择你下载的 `.py` 或 `.zip` 文件，然后点击 **安装**。
   - 安装完成后，在插件列表中找到 `灰度图合并` 插件，勾选启用它。

5. **保存配置**：
   - 勾选插件后，点击偏好设置左下角的 **保存用户设置** 按钮，以确保插件配置被保存。

### **方法二：手动安装到插件目录**
1. **下载插件**：
   - 将脚本保存为 `.py` 文件或压缩为 `.zip` 文件。

2. **找到 Blender 插件目录**：
   - 打开 Blender 安装目录，进入以下路径：
     - Windows: `C:\Program Files\Blender Foundation\Blender\2.xx\scripts\addons`（将 `2.xx` 替换为你的 Blender 版本号）。
     - macOS: `~/Library/Application Support/Blender/2.xx/scripts/addons`。
     - Linux: `~/.config/blender/2.xx/scripts/addons`。

3. **复制插件文件**：
   - 将插件的 `.py` 文件或解压后的文件夹复制到上述 `addons` 目录中。

4. **启用插件**：
   - 打开 Blender，进入 **编辑(Edit)** > **偏好设置(Preference)** > **插件(Add-ons)**。
   - 在插件列表中搜索 `灰度图合并`，勾选启用它。

### **注意事项**
- **插件兼容性**：确保插件代码与你的 Blender 版本兼容（脚本中指定的 Blender 版本为 3.6.0）。
- **文件命名**：插件文件名不能包含中文字符。
- **文件结构**：如果插件是以文件夹形式存在，确保文件夹内没有多余的嵌套结构。

安装完成后，你可以在 **着色器编辑器** 的侧边栏中找到 `灰度图合并器` 面板，开始使用该插件的功能。
